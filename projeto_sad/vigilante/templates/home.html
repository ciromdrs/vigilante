{% extends 'base.html' %}
{% block cabecalho %}
    <!-- Google Maps -->
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
    
    <script>
        // Inicialização do mapa
		function initialize() {
			var mapOptions = {
			  zoom: 15,
			  center: new google.maps.LatLng(-6.467149,-37.084322),
			  panControl: false,
			  zoomControl: false,
			  scaleControl: true,
			};
			
			// Declarando a variável do mapa
			var map = new google.maps.Map(document.getElementById('map-canvas'),
			                              mapOptions);
			
			// Marcando ponto, caso seja diferente de null
			var ponto = document.getElementById('ponto');
			if (ponto != null){
			    var latitude = ponto.value.split(',')[0];
			    var longitude = ponto.value.split(',')[1];
			    
			    // Marcando ponto
			    new google.maps.Marker({
			        map:      map,
			        position: new google.maps.LatLng(latitude, longitude),
			    });
		    }
			
			// Marcando áreas (círculos)
            new google.maps.Circle({
                map:         map,
                center:      new google.maps.LatLng(-6.4652023,-37.0942773),
                fillColor:   red,
                strokeColor: 'transparent',
                radius:      100,
            });
		}
		
        // Listener que inicializa o mapa após o carregamento da página
        // para evitar erros.
		google.maps.event.addDomListener(window, 'load', initialize);
    </script>
{% endblock %}

{% block corpo %}
    <input id='ponto' type='hidden' value='{{p}}'>
    
    <form method="post" action="/">
        {% csrf_token %}
        <input name='endereco' type='text'>
        <input type='submit' value='Marcar'>
    </form>
    
    <div>Ponto: {{p}}</div>

    <div id="map-canvas"></div>
{% endblock %}